#pragma once

#ifndef GETMESSAGES_H
#define GETMESSAGES_H
#endif

#include <stdio.h>
#include <stdlib.h>
#include "../config.h"

/**
 * @brief Execute command
 * 
 * @param argc - argument count
 * @param argv - argument array
 */
void get_messages(int argc, char *argv[])
{
    // check argument length
    if (argc != 2)
    {
        printf("%s\n", "Incorrect Usage!\nget_messages <channel_id>");
        return;
    }

    // get channel id
    char *channel_id = argv[1];

    // get url
    char url[256];
    sprintf(url, "https://discordapp.com/api/v9/channels/%s/messages", channel_id);

    // get command
    char command[4096];
    sprintf(command, "curl -H \"Authorization: %s\" \"%s\" >> messages.json", TOKEN, url);

    // run commands
    system(command);
    system("clear");

    // print
    printf("Successfully grabbed messages from channel with ID %s and saved it to \"messages.json\".\nType 'list messages' to view file data.\n", channel_id);
}