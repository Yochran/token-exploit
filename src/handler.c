#include "handler.h"

#include <string.h>

// commands
#include "commands/clear.h"
#include "commands/sendmessage.h"
#include "commands/getfriends.h"
#include "commands/getmessages.h"
#include "commands/help.h"
#include "commands/list.h"

/**
 * @brief Convert string to command
 * 
 * @param input - the inputted string
 * @return commands 
 */
command to_enum(const char *input)
{
    // code
    command command = __null__;

    // switch
    if (CODE_EQUALS(input, "clear")) command = __clear;
    if (CODE_EQUALS(input, "send_message")) command = __send_message;
    if (CODE_EQUALS(input, "get_friends")) command = __get_friends;
    if (CODE_EQUALS(input, "get_messages")) command = __get_messages;
    if (CODE_EQUALS(input, "help")) command = __help;
    if (CODE_EQUALS(input, "list")) command = __list;

    // return
    return command; 
}

/**
 * @brief Run a command
 * 
 * @param input - the inputted string
 * @param argc - argument count
 * @param argv - argument array
 */
void run_command(const char *input, int argc, char *argv[])
{
    // get command
    command command = to_enum(input);

    // switch command
    switch (command)
    {
        // execute
        case __clear:
            clear(argc, argv);
            break;
        case __send_message:
            send_message(argc, argv);
            break;
        case __get_friends:
            get_friends(argc, argv);
            break;
        case __get_messages:
            get_messages(argc, argv);
            break;
        case __help:
            help(argc, argv);
            break;
        case __list:
            list(argc, argv);
            break;
        case __null__:
            printf("Unknown command. Type 'help' for all commands.\n");
            break;
    }
}